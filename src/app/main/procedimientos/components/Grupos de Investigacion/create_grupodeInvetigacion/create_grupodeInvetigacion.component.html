<form [formGroup]="form" novalidate   enctype="multipart/form-data" >
  <p-dialog [(visible)]="displayMaximizable2" [modal]="true" 
  [style]="{'width': '65vw','height': '70vw'}" 
  [contentStyle]="{'overflow-y': 'auto'}"

  [closable]="true" [closeOnEscape]="false" 
      >
      
      <div [style]="{'margin-top':'-1px'}" >
          <!-- <div fxLayout="row" class="titleCard">
              <i class="pi pi-credit-card" style="font-size: 2rem;margin-right: 10px;"></i>
            <h2 class="fondebabutton" style="margin-top: -1px;">Registrar Grupo de Investigacion</h2>
          </div> -->
          <br>
    
            <div style="border: 1px solid black;padding: 10px;">

              <div class="grid p-fluid" style="padding: 10px;">
                <div style="border: 1px solid black;"class="col-2 md:col-2 lg:col-2">
                  <img alt="logo" src="../../../../../../assets/images/images.jpg" 
                  style="width: 100%"/>
                </div>

                <div style="border: 1px solid black;"class="col-8 md:col-8 lg:col-8">
                  <h3 style="text-align: center;">FORMALIZACIÓN GRUPO DE INVESTIGACIÓN</h3>
                </div>

                <div style="border: 1px solid black;"class="col-2 md:col-2 lg:col-2">
                  <img alt="logo" src="../../../../../../assets/images/uniguajira_iso.jpg" 
                  style="width: 100%"/>
                </div>
              </div>
              
              <div class="bordep">
                <h4 style="text-align:left;">1. NOMBRE DEL GRUPO:</h4>
                  <div class="p-inputgroup" >
                    <input type="text" class="p-inputtext-lg" pInputText name="name" 
                    placeholder="NOMBRE DEL GRUPO" formControlName="name" title="NOMBRES" required>         
                  </div>

              </div>
              <div class="bordep">
                <h4 style="text-align:left;">2. FACULTAD Y PROGRAMA ACADÉMICO DONDE SE ENCUENTRA INSCRITO EL GRUPO DE INVESTIGACIÓN:</h4>
                <p-dropdown class="visorg500-select-filter p-inputtext-lg" 
                [options]="facultys" [filter]="true" label="SELECCIONE LA FACULTAD"
                formControlName="Facultad" name="Facultad"
                  [style]="{'width':'100%','margin-bottom':'20px'}" 
                  optionvalue="id"  optionLabel="name" filterBy="name"
                  [required]="true" placeholder="SELECCIONE LA FACULTAD" title="SELECCIONE LA FACULTAD" (onChange)="SelectFacultad()">
                  <ng-template let-option pTemplate="item" >
                    <span >{{option.name | titlecase}}</span>
                </ng-template>
                </p-dropdown>

                <ng-template [ngIf]="mostrarFacultad==true">
                  <p-dropdown class="visorg500-select-filter p-inputtext-lg" 
                  [options]="FacultadHeadquarterProgram" [filter]="true" 
                  label="SELECCIONE EL PROGRAMA" 
                  formControlName="HeadquarterProgramId" name="HeadquarterProgramId"
                    [style]="{'width':'100%','margin-bottom':'20px'}" 
                    optionvalue="id"  optionLabel="name" filterBy="name"
                    [required]="true" placeholder="SELECCIONE EL PROGRAMA" 
                    title="SELECCIONE EL PROGRAMA">
                    <ng-template let-option pTemplate="item" >
                      <span >Sede: {{option.Sede | titlecase}} -
                        Programa: {{option.Programa | titlecase}}</span>
                  </ng-template>
                  </p-dropdown>
                </ng-template>

              </div>

              <div class="bordep">
                <h4 style="text-align:left;">3. INTEGRANTES DEL GRUPO:</h4>

                <h5 style="text-align:left;">3.1. Director y/o Investigador Principal:</h5>
                <p-dropdown class="visorg500-select-filter p-inputtext-lg" 
                  [options]="teachers" [filter]="true" 
                  label="SELECCIONE EL INVESTIGADOR PRINCIPAL" 
                  formControlName="TecaherId" name="TecaherId"
                    [style]="{'width':'100%'}" 
                    optionvalue="id"  optionLabel="User.fullName" filterBy="User.fullName"
                    [required]="true" placeholder="SELECCIONE EL INVESTIGADOR PRINCIPAL" (onChange)="SelectTeacher()"
                    title="SELECCIONE EL INVESTIGADOR PRINCIPAL">
                    <ng-template let-option pTemplate="item" >
                      <span >{{option.User.fullName  | titlecase}} -
                      cc: {{option.User.Person.identification }} 
                      </span>
                  </ng-template>
                  </p-dropdown>
                  
                  <ng-template [ngIf]="mostrarTeacher == true">
                    <br><br>
                    <p-fieldset legend="Datos del Docente">
                      <div class="flex" >
                        <div class="col-12 md:col-6 lg:col-6" style="margin-top:-20px">
                          <h3 class="fondebabutton">Nombre : {{ form2.User?.fullName | titlecase }}</h3>
                          <h3 class="fondebabutton">Identificacion : {{ form2.User?.Person?.identification | titlecase }}</h3>
                          <h3 class="fondebabutton">Correo : {{ form2.User?.email| titlecase }}</h3>
                          
                        </div>
                        <p-divider layout="vertical" ></p-divider>
                        <div class="col-12 md:col-6 lg:col-6"  style="margin-top:-20px">
                          <h3 class="fondebabutton">Telefono : {{ form2.User?.Person?.phone }}</h3>
                          <h3  class="fondebabutton">Categoria Colciencias : {{ form2.ColcienciaCategory?.name| titlecase }}</h3>
                          <h3  class="fondebabutton">Escalafón : {{ form2.Scale?.name | titlecase }}</h3>
                          <!-- <h3 class="fondebabutton">Grupo de Investigacion : {{ form2.Group?.name | titlecase}}</h3> -->
                        </div>
                      </div>
                      </p-fieldset>
                  </ng-template>

                <h5 style="text-align:left;">3.2. Investigadores Secundarios o Coinvestigadores:</h5>

                <div fxLayout="row" fxLayoutGap="20px">
    
                   <button pButton type="button" (click)="addInvestigatorCollaborators($event)" style="margin-right: 15px;" 
                  class="p-button-success p-button-raised p-button-rounded"
                   label="Add Investigadores Secundarios"></button> 

                   <button pButton type="button" (click)="addInvestigator($event)" 
                   class="p-button-info p-button-raised p-button-rounded"
                    label="Crear nuevo Investigador"></button> 
                </div>
      
                <br>
    
                <div fxLayout="row" fxLayoutGap="20px">
                  <div class="table-wrapper" >
                    <p-table [value]="algoI" *ngIf="mostrarI == true"> 
                      <ng-template pTemplate="header">
                        <tr>
                            <th pSortableColumn="id">Investigadores Secundarios<p-sortIcon field="id"></p-sortIcon></th>
                        </tr>
                    </ng-template>
                    <ng-template pTemplate="body" let-rowData let-item let-expanded="expanded">
                      <tr [pSelectableRow]="rowData">
                          <td>
                            <div formArrayName="InvestigatorCollaborators"> 
                              <div *ngFor="let item of getInvestigatorCollaborator.controls; 
                              let pointIndex=index" [formGroupName]="pointIndex">
                                <div class="grupo"> 
                                  <div class="grupoinput1">
                                    <p-dropdown class="visorg500-select-filter p-inputtext-lg" 
                                    [options]="users" [filter]="true"
                                        formControlName="UserId" name="UserId"
                                       label="SELECCIONE INVESTIGADOR" 
                                      [style]="{'width':'100%','margin-bottom':'20px'}"
                                      optionvalue="id" optionLabel="User.fullName" filterBy="User.fullName"
                                      [required]="true" placeholder="SELECCIONE INVESTIGADOR"  >
                                      <ng-template let-option pTemplate="item"  >
                                        <span >{{option.User.fullName  | titlecase}} -
                                          cc: {{option.identification }} 
                                          </span>
                                    </ng-template>
                                    </p-dropdown></div>
                                    <div class="grupoinput1">
                                    <p-dropdown class="visorg500-select-filter p-inputtext-lg" 
                                    [options]="roles" [filter]="true"
                                        formControlName="RoleId" name="RoleId"
                                       label="SELECCIONE ROL DE INVESTIGACIÓN" 
                                      [style]="{'width':'100%','margin-bottom':'20px'}"
                                      optionvalue="id" optionLabel="name" filterBy="name"
                                      [required]="true" placeholder="SELECCIONE ROL DE INVESTIGACIÓN"  >
                                      <ng-template let-option pTemplate="item"  >
                                        <span >{{option.name  | titlecase}} 
                                         
                                          </span>
                                    </ng-template>
                                    </p-dropdown>
                                  </div>
                                  
                                <span class="bottomdelete" style="margin-top: 5px;">
                                  <button pButton pRipple type="button" icon="pi pi-times" (click)="removeInvestigatorCollaborators(pointIndex,$event)"  
                                  class="p-button-rounded p-button-danger"></button>
                                  <!-- <button pButton type="button" class="p-button-danger p-button-raised p-button-rounded"
                                  (click)="removeRoles(pointIndex,$event)" 
                                  label="eliminar"></button> -->
                                </span>
                                
                              </div>
                              </div>
                            </div> 
                          </td>
                      </tr>
                    </ng-template>
                    </p-table>
                  </div>
                </div>

                <p><b>Nota: </b>Todos los integrantes del grupo deben diligenciar el CVLAC, donde será verificable la trayectoria académica de cada uno y el GRUPLAC del grupo.</p> 
                 

              </div>


              <div class="bordep">
                <h4 style="text-align:left;">4. OBJETIVOS</h4>
                <h5 style="text-align:left;">4.1 General:</h5>
                <div class="p-inputgroup" >
                  <input type="text" class="p-inputtext-lg" pInputText name="name" 
                  placeholder="Objetivo General" formControlName="ObjetivoGeneral" title="Objetivo General" required>         
                </div>

                <h5 style="text-align:left;">4.2. Especificos:</h5>
                <div class="p-inputgroup" >
                  <textarea rows="5" cols="30" [style]="{'border-radius':'10px'}" pInputTextarea [autoResize]="true"
                  formControlName="ObjetivosEspecificos" required></textarea>
                        
                </div>
              </div>

              <div class="bordep">
                <h4 style="text-align:left;">5. MISIÓN, VISIÓN Y PERFIL</h4>
                <div class="p-inputgroup" style="margin-bottom: 10px;">
                  <textarea rows="3" cols="30" [style]="{'border-radius':'10px'}" pInputTextarea [autoResize]="true"
                  formControlName="Mision" placeholder="ESCRIBIR LA MISION"  required></textarea>
                  
                </div>
                <div class="p-inputgroup"  style="margin-bottom: 10px;">
                  <textarea rows="3" cols="30" [style]="{'border-radius':'10px'}" pInputTextarea [autoResize]="true"
                  formControlName="Vision" placeholder="ESCRIBIR LA VISION"  required></textarea>
      
                </div>
                <div class="p-inputgroup" >
                  <textarea rows="3" cols="30" [style]="{'border-radius':'10px'}" pInputTextarea [autoResize]="true"
                  formControlName="Perfil" placeholder="ESCRIBIR EL PERFIL"  required></textarea>
                   
                </div>
              </div>

              <div class="bordep">
                <h4 style="text-align:left;">6.  METAS E INDICADOR DE LOGROS </h4>
                <div class="p-inputgroup" style="margin-bottom: 10px;">
                  <textarea rows="3" cols="30" [style]="{'border-radius':'10px'}" pInputTextarea [autoResize]="true"
                  formControlName="Metas" placeholder="ESCRIBIR LA METAS"  required></textarea>
                </div>
              </div>
              <div class="bordep">
                <h4 style="text-align:left;">7. RESULTADOS ESPERADOS Y PRODUCTOS </h4>
                <div class="p-inputgroup" style="margin-bottom: 10px;">
                  <textarea rows="3" cols="30" [style]="{'border-radius':'10px'}" pInputTextarea [autoResize]="true"
                  formControlName="Resultados" placeholder="ESCRIBIR LOS RESULTADOS"  required></textarea>
                </div>
                <p><b>Nota: </b>(Para el caso  de Artículos Científicos, indicar: nombre del artículo, nombre la publicación, año de impresión. Para el caso de Libro, indicar: Nombre, año de impresión, editorial)</p> 
                  
              </div>

              <div class="bordep">
                <h4 style="text-align:left;">8.  LINEA DE INVESTIGACIÓN Y TEMÁTICAS ASOCIADAS AL GRUPO</h4>
                
                <div fxLayout="row" fxLayoutGap="20px">
    
                  <button pButton type="button" 
                  (click)="addlines($event)" style="margin-right: 15px;" 
                 class="p-button-success p-button-raised p-button-rounded"
                  label="Add Lineas"></button> 
               </div>
     
               <br>
   
               <div fxLayout="row" fxLayoutGap="20px">
                 <div class="table-wrapper" >
                   <p-table [value]="algo" *ngIf="mostrar == true"> 
                     <ng-template pTemplate="header">
                       <tr>
                           <th pSortableColumn="id">Lineas<p-sortIcon field="id"></p-sortIcon></th>
                       </tr>
                   </ng-template>
                   <ng-template pTemplate="body" let-rowData let-item let-expanded="expanded">
                     <tr [pSelectableRow]="rowData">
                         <td>
                           <div formArrayName="lines"> 
                             <div *ngFor="let item of getlines.controls; 
                             let pointIndex=index" [formGroupName]="pointIndex">
                               <div class="grupo"> 
                                 <div class="grupoinput">
                                   <p-dropdown class="visorg500-select-filter p-inputtext-lg" 
                                   [options]="lines" [filter]="true"
                                       formControlName="LineId" name="LineId"
                                      label="SELECCIONE LINEA" 
                                     [style]="{'width':'100%','margin-bottom':'20px'}"
                                     optionvalue="id" optionLabel="name" 
                                     filterBy="name"
                                     [required]="true" placeholder="SELECCIONE LINEA"  >
                                     <ng-template let-option pTemplate="item"  >
                                       <span >{{option.name  | titlecase}}
                                         </span>
                                   </ng-template>
                                   </p-dropdown></div>
                                 
                               <span class="bottomdelete" style="margin-top: 5px;">
                                 <button pButton pRipple type="button" icon="pi pi-times" (click)="removelines(pointIndex,$event)"  
                                 class="p-button-rounded p-button-danger"></button>
                                 <!-- <button pButton type="button" class="p-button-danger p-button-raised p-button-rounded"
                                 (click)="removeRoles(pointIndex,$event)" 
                                 label="eliminar"></button> -->
                               </span>
                               
                             </div>
                             </div>
                           </div> 
                         </td>
                     </tr>
                   </ng-template>
                   </p-table>
                 </div>
               </div>

                <ng-template [ngIf]="mostrarLienas==true">
                  <p-table [value]="lines" > 
                    <ng-template pTemplate="header">
                      <tr>
                          <th pSortableColumn="name">Nombre de Lineas<p-sortIcon field="name"></p-sortIcon></th>
                          <th pSortableColumn="resolution">Resolución<p-sortIcon field="resolution"></p-sortIcon></th>
                      </tr>
                  </ng-template>
                  <ng-template pTemplate="body" let-item>
                    <tr>
                      <td>{{item.name | titlecase}}</td>
                      <td>{{item.resolution | titlecase}}</td>
                    </tr>
                  </ng-template>
                  <ng-template pTemplate="emptymessage">
                    <tr>
                        <td colspan="6" style="text-align: center;">
                          <h3>No hay registros encontrados</h3>
                        </td>
                    </tr>
                </ng-template>
                  </p-table>
                

                </ng-template>
                <p><b>Nota: </b>(Lineas asociadas al Investigador principal)</p> 
              </div>


              <div class="bordep">
                <h4 style="text-align:left;">9.  SECTOR DE APLICACIÓN </h4>
                <div class="p-inputgroup" style="margin-bottom: 10px;">
                  <textarea rows="3" cols="30" [style]="{'border-radius':'10px'}" pInputTextarea [autoResize]="true"
                  formControlName="Sector" placeholder="ESCRIBIR SECTOR"  required></textarea>
                </div>
              </div>

              <div class="bordep">
                <h4 style="text-align:left;">10.  SEMILLEROS ASOCIADOS AL GRUPO</h4>

                
                <div fxLayout="row" fxLayoutGap="20px">
    
                  <button pButton type="button" (click)="addSeedbed($event)" style="margin-right: 15px;" 
                 class="p-button-success p-button-raised p-button-rounded"
                  label="Add Semilleros"></button> 
               </div>
     
               <br>
   
               <div fxLayout="row" fxLayoutGap="20px">
                 <div class="table-wrapper" >
                   <p-table [value]="algoS" *ngIf="mostrarS == true"> 
                     <ng-template pTemplate="header">
                       <tr>
                           <th pSortableColumn="id">Semilleros<p-sortIcon field="id"></p-sortIcon></th>
                       </tr>
                   </ng-template>
                   <ng-template pTemplate="body" let-rowData let-item let-expanded="expanded">
                     <tr [pSelectableRow]="rowData">
                         <td>
                           <div formArrayName="Seedbed"> 
                             <div *ngFor="let item of getSeedbed.controls; 
                             let pointIndex=index" [formGroupName]="pointIndex">
                               <div class="grupo"> 
                                 <div class="grupoinput">
                                   <p-dropdown class="visorg500-select-filter p-inputtext-lg" 
                                   [options]="Seedbeds" [filter]="true"
                                       formControlName="SeedbedId" name="SeedbedId"
                                      label="SELECCIONE SEMILLERO" 
                                     [style]="{'width':'100%','margin-bottom':'20px'}"
                                     optionvalue="id" optionLabel="name" 
                                     filterBy="name"
                                     [required]="true" placeholder="SELECCIONE SEMILLERO"  >
                                     <ng-template let-option pTemplate="item"  >
                                       <span >{{option.name  | titlecase}}
                                         </span>
                                   </ng-template>
                                   </p-dropdown></div>
                                 
                               <span class="bottomdelete" style="margin-top: 5px;">
                                 <button pButton pRipple type="button" icon="pi pi-times" (click)="removeSeedbed(pointIndex,$event)"  
                                 class="p-button-rounded p-button-danger"></button>
                                 <!-- <button pButton type="button" class="p-button-danger p-button-raised p-button-rounded"
                                 (click)="removeRoles(pointIndex,$event)" 
                                 label="eliminar"></button> -->
                               </span>
                               
                             </div>
                             </div>
                           </div> 
                         </td>
                     </tr>
                   </ng-template>
                   </p-table>
                 </div>
               </div>
<!-- 
                <ng-template [ngIf]="mostrarLienas==true">
                  <p-table [value]="Seedbeds" > 
                    <ng-template pTemplate="header">
                      <tr>
                          <th pSortableColumn="name">Nombre de Semilleros<p-sortIcon field="name"></p-sortIcon></th>
                      </tr>
                  </ng-template>
                  <ng-template pTemplate="body" let-item>
                    <tr>
                      <td>{{item.name | titlecase}}</td>
                    </tr>
                  </ng-template>
                  <ng-template pTemplate="emptymessage">
                    <tr>
                        <td colspan="6" style="text-align: center;">
                          <h3>No hay registros encontrados</h3>
                        </td>
                    </tr>
                </ng-template>
                  </p-table>
                

                </ng-template>
                <p><b>Nota: </b>(Semilleros asociadas al Investigador principal)</p> -->
              </div>

              <div style="border: 1px solid black;padding: 10px">
                <h4 style="text-align:left;">11. ANEXOS:</h4>
                <div fxLayout="row" fxLayoutGap="20px">
                  <button pButton type="button" (click)="addAnexos($event)" 
                  class="p-button-warning p-button-raised p-button-rounded"
                   label="Add Anexos"></button>  
                </div>
      
                <br>
                <div fxLayout="row" fxLayoutGap="20px">
                  <div class="table-wrapper" >
                    <p-table [value]="algo2" *ngIf="mostrar2 == true"> 
                      <ng-template pTemplate="header">
                        <tr>
                            <th pSortableColumn="id">Anexos<p-sortIcon field="id"></p-sortIcon></th>
                        </tr>
                    </ng-template>
                    <ng-template pTemplate="body" let-rowData let-item let-expanded="expanded">
                      <tr [pSelectableRow]="rowData">
                          <td>
                            <div formArrayName="Anexos"> 
                              <div *ngFor="let item of getAnexos.controls; 
                              let pointIndex=index" [formGroupName]="pointIndex">
                                <div class="grupo"> 
                                  <div class="grupoinput1 custom-input-file">
                                    <input type="file" class="input-file p-inputtext-lg" style="margin-bottom: 10px;" 
                                    name="Anexos" 
                                    placeholder="Anexo" formControlName="Anexos" title="Anexos" required>
                                  </div>
                                  
                                <span class="bottomdelete" style="margin-top: 5px;">
                                  <button pButton pRipple type="button" icon="pi pi-times" (click)="removeAnexos(pointIndex,$event)"  
                                  class="p-button-rounded p-button-danger"></button>
                                </span>
                                
                              </div>
                              </div>
                            </div> 
                          </td>
                      </tr>
                    </ng-template>
                    </p-table>
                  </div>
                </div>
                <p><b>Nota: </b> </p>
                 <p>A. Copia del Acta del Comité de investigaciones de la Facultad, donde el Comité de investigaciones Avale dicho grupo firmada por el decano y el coordinador de investigaciones.</p> 
                  <p>B. Copia de Hoja de Vida en resumen de cada uno de los integrantes.</p>
                 <p> C. Plan Estratégico</p>
              </div>


                          
            <div fxLayout="row" class="titleCard" style="margin-top: 20px">
              <button pButton type="submit" (click)="onSubmit($event)" [disabled]="!form.valid"
               icon="pi pi-check" class="p-button-success p-button-raised p-button-rounded" 
               label="Enviar Registro" styleClass="mr-2"></button>
            <p-button (click)="displayMaximizable2=false" icon="pi pi-times" styleClass="p-button-text" label="Cancelar"></p-button>
        </div>

            </div>
  
      

               
      
      </div>


       
        
            
</p-dialog>
</form>
<p-toast></p-toast>

<p-confirmPopup></p-confirmPopup>
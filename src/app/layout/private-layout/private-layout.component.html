
<ng-template [ngIf]="isLoggedIn === true">
  <div class="grid"  [style]="{'background':'#f16357',
  'color':'#fff','font-weight':'bold','margin':'0',
  'border':'1px solid #f16357','border-radius':'0px'}">

  <div class="col-12 sm:col-2 md:col-3 lg:col-3 xl:col-3">
    <p-button styleClass="p-button-outlined  p-button-warning" (click)="display = true" class="mr-3">
      <i class="pi pi-align-justify"  style="font-size: 1.5rem; margin-top: 5px;color:black"></i>
        <!-- <img alt="logo" src="assets/avatars-avataaars.png" style="width: 1.5rem"/> -->
        <span class="ml-2 font-bold" style="color:#FBC02D">SIGINV - UNIGUAJIRA</span>
    </p-button>
  </div>
  <div class="col-12 sm:col-2 md:col-3 lg:col-4 xl:col-5"></div>
  <div class="col-12 sm:col-7 md:col-6 lg:col-5 xl:col-4">

    <div class="grid">
      <div class="col-12 sm:col-12 md:col-2 lg:col-2 xl:col-2">
        <ng-template [ngIf]="notifications_noleidos.length > 0">
          <i class="pi pi-bell ml-4 mt-2" 
          pBadge style="font-size: 1.5rem" value="{{notifications_noleidos.length}}" 
          (click)="op.toggle($event)"></i>
        </ng-template>
        <ng-template [ngIf]="notifications_noleidos.length == 0">
          <i class="pi pi-bell ml-4 mt-2 " 
           style="font-size: 1.5rem" value="" 
          (click)="op.toggle($event)"></i>
        </ng-template>
      </div>
      <div class="col-12 sm:col-12 md:col-8 lg:col-8 xl:col-8">
        <button pButton pRipple type="button"  [disabled]="true"
        class="p-button-outlined  p-button-warning ml-3"
        style="padding: 7px;">
        <div class="clock" style="color:#FBC02D;font-weight:bold">
          {{dia | titlecase}} {{fecha | titlecase}} [<span class="mishoras">{{hora}}:{{minutos}}:<span class="segundos">{{segundos}}</span></span><span class="ampm">{{ampm}}</span>]
        </div>
         </button>
      </div>
      <div class="col-12 sm:col-12 md:col-2 lg:col-2 xl:col-2">
        <button type="button" pButton pRipple 
        class="p-button-rounded p-button-text"
         icon="pi pi-plus" (click)="menu.toggle($event)">
          <p-avatar image="{{image3}}" 
          styleClass="ml-3" size="large" shape="circle"></p-avatar>
        </button>
      </div>
    </div>
     <p-menu #menu [popup]="true"  [model]="items" 
     [style]="{'width':'200px','margin-top':'5px'}"></p-menu>
     <div #menu2 class="box hidden" header="Anuncios" 
     style="display: inline-block;margin:0px">

    </div>
  </div>
  </div>
  <!-- notificaciones -->
  
  <p-overlayPanel #op [showCloseIcon]="false" [dismissable]="true"[style]="{width: '450px'}">
    <ng-template pTemplate>
      <ng-template [ngIf]="recipients.length">
        <span *ngFor="let item of recipients" >
            <div class="grid">
              <div class="col-12 ">
                  <div class="surface-card shadow-2 p-3 border-round">
                      <div class="flex justify-content-between mb-3">
                          <div>
                              <span class="block text-500 font-medium mb-3"> {{item.Notification?.title | titlecase}}</span>
                              <div class="text-900 font-medium text-xl">{{item.Notification?.abstract}}</div>
                          </div>
                          <div class="flex align-items-center 
                          justify-content-center " 
                          style="width:3.5rem;height:3.5rem">
                          <p-avatar image="{{item.Notification?.User?.avatar}}" [title]="item.Notification?.User?.email"
                          styleClass="ml-3" size="xlarge" shape="circle"></p-avatar>
                          </div>
                      </div>
                      <!-- <span class="text-green-500 font-medium">
                        {{item.Notification?.User?.fullName}}
                      </span> -->
                      <span class="text-500">{{item.Notification?.date_firt}}</span>
                      <span class="text-blue-500 font-medium ml-1"
                      style="cursor:pointer; cursor: hand"
                       (click)="mostrarNOtificaciones($event)">
                        Detalle
                      </span>
                  </div>
              </div>
            </div>
            <hr>

        </span>
        <div class="flex justify-content-center align-items-center  mb-3" *ngIf="notifications.length > 3">
          <span class="text-900 font-medium text-xl" 
          style="text-align: center;margin-top: -15px;"> Ver Mas</span>
        </div>
      </ng-template>

         <ng-template [ngIf]="!recipients.length">
                  <p-card [style]="{'height':'70px',
                  'text-aling':'center','padding': '0px'}">
                  <div class="flex justify-content-center align-items-center  mb-3">
                    <span class="text-900 font-medium text-xl" 
                    style="text-align: center;margin-top: -15px;"> No hay Anuncios</span>
                  </div>

        </p-card>

      </ng-template>
      
      
     
    </ng-template>
</p-overlayPanel>



  <div class="container margen">
      <p-sidebar [(visible)]="display" 
      [style]="{'width':'345px','min-height': '88vh'}"  [showCloseIcon]="true" 
      [blockScroll]="false" >
      <a routerLink="/landing" (click)="display=false">
          <img alt="logo" src="assets/images/logo-uniguajira.png" width="260px" height="92px" style="margin-left: 20px ;margin-top: -7px;" 
          styleClass="p-button-outlined"class="mr-3"/><!-- (click)="display = true"  -->
      </a>
      <h4 class="fondebabutton" style="text-align: center;margin-bottom:-5px">{{nombre}}</h4>
      <hr>
          <!-- <p-panelMenu [model]="items" [style]="{'width':'192px','margin-left':'-5px'}"></p-panelMenu> -->
          <app-menu [menu]="menu1" (funcion)="ocultarMenu($event)"></app-menu>
          <!-- <div  class="padre grid align-items-center justify-content-cente">
              <span (click)="cerrarSesion()" 
              style="padding-left: 10px;padding-bottom: 10px;padding-top: 10px; cursor: pointer;">
                <i class="pi pi-power-off"  style="font-size: 1.5rem; margin-top: 5px;"></i>
                <span class="ml-4 font-bold" style=" width: 500px; font-size: 18px;">Logout</span>
              </span>
          </div> -->
      </p-sidebar>
      <div class="content">
        
        <router-outlet></router-outlet>
        <footer class="footer" style="padding-top: 20px;">
            
          <div class="footer__copyright" >
            <p>&copy; 2022</p>
            <p>Desarrollo Universidad de la Guajira - Programa Ing de Sistemas</p>
          </div>
      
          <div class="image"> 
            <img src="{{image2}}" alt="">
          </div>
        </footer>

      </div>
    </div>  

</ng-template>
<!-- cerrar seccion -->
<p-dialog [(visible)]="Dialog" 
[style]="{'height': '18vw','width': '25vw'}"[resizable]="false" zindex="10000"
 [showHeader]="false" [closeOnEscape]="false" [closable]="false"
[modal]="true" >

    <div class="flex flex-column " style="flex: 1">
        <div class="text-center">
            <i class="pi pi-exclamation-triangle" style="font-size: 3rem"></i>
            <h4>Esta seguro de Cerrar la Sesion?</h4>
            <p>Si para continuar</p>
        </div>
    </div>

  <ng-template pTemplate="footer" class="titleCard" >
    <div style="text-align: center;">
      <button pButton pRipple label="No" icon="pi pi-times" style="color: rgb(31, 45, 64);" 
      class="p-button-text" (click)="hideDialog()"></button>
      <button pButton pRipple label="Si"  style="background: #f16357" 
      class=" p-button-raised p-button-rounded" 
      icon="pi pi-check"  (click)="cerrarSesion()"  ></button>
    </div>
  </ng-template>
</p-dialog>

<!-- cambio de clave -->
<ng-template [ngIf]="mostrarDialogoClave == true">
    <form [formGroup]="form" novalidate (ngSubmit)="onSubmit()">
      <p-dialog [(visible)]="mostrarDialogoClave" [modal]="true" [style]="{'width': '40vw'}" 
      [closable]="false" [closeOnEscape]="false" [resizable]="false" zindex="10000"  [showHeader]="false"   >
    <br>
    
    
    <div [style]="{'margin-top':'-1px'}" >
      <div fxLayout="row" class="titleCard">
        <i class="pi pi-key" style="font-size: 2rem;margin-right: 10px;"></i>
        <h2 class="fondebabutton" style="margin-top: -1px;">Cambiar Contraseña</h2>
      </div>

      <div class="p-inputgroup" [style]="{'margin-top':'20px','margin-bottom':'40px'}">
        <span class="p-inputgroup-addon"  style="margin-top:-1px;" title="Actual Contraseña">
          <i class="pi pi-lock-open"></i></span>
        <input type="password" class="p-inputtext-lg" pInputText name="oldPassword" 
        placeholder="Actual Contraseña" formControlName="oldPassword"
        required>  
  
    </div>

    <div class="p-inputgroup" [style]="{'margin-top':'20px','margin-bottom':'40px'}">
      <span class="p-inputgroup-addon"  style="margin-top:-1px;" title="Nueva Contraseña">
        <i class="pi pi-lock"></i></span>
      <input type="password" class="p-inputtext-lg" pInputText name="newPassword" 
      placeholder="Nueva Contraseña" formControlName="newPassword" required
      required>  

  </div>
  </div>
  <ng-template [ngIf]="motrar == false">
  <div fxLayout="row" class="titleCard"style="margin-top: -20px;">
    <p-button (click)="mostrarDialogoClave = false" icon="pi pi-times" styleClass="p-button-text" label="Cancelar"></p-button>

    <button pButton type="button" type="submit"  icon="pi pi-check" [disabled]="!form.valid"
    class="p-button-warning p-button-raised p-button-rounded" 
    label="Modificar Clave" styleClass="mr-2"></button>
  </div>
  </ng-template>
  <ng-template [ngIf]="motrar == true">
    <br>
    <!-- <p-progressBar [value]="cargando"></p-progressBar> -->
    <!-- <div fxLayout="row" class="titleCard"style="margin-top: 20px;"> -->
      <p-progressBar mode="indeterminate"  [style]="{'height': '6px'}"></p-progressBar>

    <!-- </div> -->

  </ng-template>
      </p-dialog>
      </form>
      <p-toast></p-toast>
      <p-confirmPopup></p-confirmPopup>
</ng-template>
<!-- cambiar avatar -->
<ng-template [ngIf]="mostrarAvatarClave == true">
  <form [formGroup]="form2" novalidate (ngSubmit)="onSubmit2()">
    <p-dialog [(visible)]="mostrarAvatarClave" [modal]="true" [style]="{'width': '80vw'}" 
    [closable]="false" [closeOnEscape]="false" [resizable]="false" zindex="10000"  [showHeader]="false"   >

  
    <div [style]="{'margin-top':'-1px'}" >
      <div fxLayout="row" class="titleCard1">
        <i class="pi pi-user" style="font-size: 2rem;margin-right: 10px;"></i>
        <h2 class="fondebabutton" style="margin-top: -1px;">Imagen de Perfil</h2>
      </div>
      <div class="grid">
  
        <div class="col-12 md:col-5" style="border: 1px solid black; border-radius:5px">
          <span class="p-inputgroup-addon"  style="margin-top:-1px;" title="Avatar Actual">
            <i class="pi pi-user mr-2"></i>Imagen Actual</span>
          <!-- <div class="" style="width:100%"> -->
            <span class="flex">
              <p-avatar image="{{image3}}"  pRipple 
              [style]="{'width':'350px','height':'350px','border':'4px solid #f16357'}"
              styleClass="imgLogo4 mt-5 ml-5 p-button-rounded p-button-outlined" 
              size="xlarge" shape="circle"></p-avatar>
              <!-- <img class="imgLogo4" src="{{image3}}" alt="" 
              title="Avatar Actual"  styleClass="p-button-outlined"> -->
              <div circle class="mt-10" style="margin-left: -55px; margin-top: 300px;"> 
                <button pButton pRipple type="button" icon="pi pi-camera" 
                (click)="adjuntar=true" title="Adjuntar imagen"
                class="p-button-rounded p-button-secondary" style="font-size: 2rem;border:2px solid #f16357"></button></div>
              </span>
              
 
           
          <!-- </div> -->
          <br>
          <br>
          <!-- <div class="field ">
            <label for="name"style="font-weight: bold;">Adjuntar Imagen</label>
          
        <div class="p-inputgroup" >
        <span class="p-inputgroup-addon mt-2"  style="color:#F16257;height:40px"><i class="pi pi-bookmark-fill"></i></span>

          <span class="p-float-label" 
          [style]="{'width':'100%'}">

          <div class="custom-input-file" style="width: 100%;">
            <input type="file" 
            class="input-file p-inputtext-lg" 
            style="margin-bottom: 10px;" 
            name="avatarImagen" 
            placeholder="Adjuntar Imageb" 
            style="width: 80%;"
            formControlName="avatarImagen" 
            accept="image/png, image/gif, image/jpeg"
            title="Adjuntar Imageb" required (change)="onFileChange($event)">
            <span class="bottomdelete mt-7"  *ngIf="form2.value.avatarImagen != undefined && form2.value.avatarImagen != ''"
            style="margin-left: 5px ;">
              <button pButton pRipple type="button" icon="pi pi-check"   
              class="p-button-rounded p-button-success"></button>

            </span>
          </div>
          </span>       
        </div>
      </div> -->

      

        </div>
        <div class="col-12 md:col-7" style="border: 1px solid black; border-radius:5px">
          <span class="p-inputgroup-addon"  style="margin-top:-1px;" title="Avatar Actual">
            <i class="pi pi-user mr-2"></i>Avatar</span>
  
            <div class="card">
              <p-dataView #dv [value]="images" [paginator]="true" [rows]="6" filterBy="name"
                   layout="grid">
  
                  <ng-template let-product pTemplate="gridItem">
                      <div class="col-12 md:col-4">
                          <div class="product-grid-item card">
                              <div class="product-grid-item-content">
                                <img src="{{product.src}}" width="100%" class="product-image" />
       
                              </div>
                              <div class="product-grid-item-bottom">
                                <div fxLayout="row" class="titleCard"style="margin-top: 5px;">
                                  <p-button icon="pi pi-check-circle"  styleClass="p-button-text" 
                                  label="Seleccionar" width="100%" 
                                  (click)="seleccionar(product.src,$event)"></p-button>
  
                                </div>
                              </div>
                          </div>
                      </div>
                  </ng-template>
              </p-dataView>
          </div>
        </div>
  
          <input type="hidden" class="p-inputtext-lg" pInputText name="avatar" 
          placeholder="Nueva Contraseña" formControlName="avatar"
          required>  
      </div>

  </div>
    <ng-template [ngIf]="motrar == false">
      <div fxLayout="row" class="titleCard"style="margin-top: 5px;">
        <br>
        <p-button (click)="mostrarAvatarClave=false" icon="pi pi-times" styleClass="p-button-text" 
        label="Cancelar"></p-button>
      
        <button pButton type="button" type="submit"  icon="pi pi-check" [disabled]="imagenNueva == null && form2.value.avatar == ''"
        class="p-button-warning p-button-raised p-button-rounded" 
        label="Modificar Imagen" styleClass="mr-2"></button>
      </div>
  </ng-template>
  <ng-template [ngIf]="motrar == true">
    <br>
    <br>
    <!-- <p-progressBar [value]="cargando"></p-progressBar> -->
    <!-- <div fxLayout="row" class="titleCard"style="margin-top: 20px;"> -->
      <p-progressBar mode="indeterminate"  [style]="{'height': '6px'}"></p-progressBar>

    <!-- </div> -->

  </ng-template>
  
  </p-dialog>
  </form>
  <p-toast></p-toast>
  <p-confirmPopup></p-confirmPopup>
</ng-template>


<!-- adjuntarimagen -->
<p-dialog [(visible)]="adjuntar" 
[style]="{'height': '67%','width': '67%'}"[resizable]="false" zindex="10000"
[showHeader]="false" [closeOnEscape]="false" [closable]="false"
[modal]="true" >

    <div class="flex flex-column " style="flex: 1">
        <div class="text-center">
          <div fxLayout="row" class="titleCard1">
            <i class="pi pi-camera mt-1 mb-2" style="font-size: 3rem ;margin-right: 10px;"></i>
            <h2 class="fondebabutton mt-2">Adjuntar Imagen</h2>
          </div>
      
        <div class="card">
          <p-fileUpload #file (change)="onFileChange($event,file)"
          [style]="{'background-color': '#f16357'}"
          [showUploadButton]="false" [showCancelButton]="false" [previewWidth]="150"
          chooseLabel="Cargar Imagen"
          [multiple]="true" accept="image/*" [maxFileSize]="1000000" [fileLimit]="1">
          <ng-template pTemplate="content">
              <ul *ngIf="uploadedFiles.length">
                  <li *ngFor="let file of uploadedFiles">{{file.name}} - {{file.size}} bytes</li>
              </ul>
          </ng-template>
        </p-fileUpload>
        </div>
          
        </div>
    </div>
    
<ng-template pTemplate="footer" class="titleCard" >
  <ng-template [ngIf]="adjuntarM == false">
      <div style="text-align: center;">
        <button pButton pRipple label="Cancelar" icon="pi pi-times" style="color: rgb(31, 45, 64);" 
        class="p-button-text" (click)="adjuntarCancelar(file)"></button>
        <button pButton type="button"  icon="pi pi-check" 
        [disabled]="imagenNueva == null" (click)="onSubmit2()"
        class="p-button-raised p-button-rounded" style="background: #f16357" 
        label="Cambiar Imagen" styleClass="mr-2"></button>
      </div>
    </ng-template>
    <ng-template [ngIf]="adjuntarM == true">
      <br>
      <!-- <ng-template pTemplate="footer" class="titleCard" > -->
      <!-- <p-progressBar [value]="cargando"></p-progressBar> -->
      <!-- <div fxLayout="row" class="titleCard"style="margin-top: 20px;"> -->
        <p-progressBar mode="indeterminate"  [style]="{'height': '6px'}"></p-progressBar>
      </ng-template>

    </ng-template>
</p-dialog>
